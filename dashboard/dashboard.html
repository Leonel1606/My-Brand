
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin</title>
    <link rel="stylesheet" href="./DashBoard.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Kanit:wght@100&display=swap" rel="stylesheet">
<script src="https://kit.fontawesome.com/c6d6e74636.js" crossorigin="anonymous"></script>
<link rel="stylesheet" href="/blogs/blogs.css">
<style>
  .all{
        background-color: rgba(37, 126, 209, 0.233);
        display: flex;
        flex-basis: 1;
        line-height: 30px;
        gap: 20px;
        padding: 20px;
    }
    
    button {
        color: blue;
        height: 30px;
        width: 100px;
        margin-top: 30px;
        

    }
</style>  
</head>
<body>
    <div class="dash-container">
        <div class="top-items">
            <div class="left-items">
                <h3>ADMIN PANEL.</h3>
                <ul>
                    <li>DashBoard</li>
                    <li>Users</li>
                </ul>
            </div>
            <div class="right-items">
                
                <ul>
                    <li>Help</li>
                    <li>Settings</li>
                </ul>
                <div class="profile">
                    <h3>L</h3>
                </div>
            </div>
        </div>
        <hr>
        <div class="Second-top-items">
            <div class="second-left-items">
                <h2>My DashBoard</h2>
            </div>
            <div class="second-right-items">
                <div class="message-blogs-list">
                    <ol>
                        <a href="./CheckMails.html" title="Users mails"><li><i class="fa-regular fa-message"></i></li></a> 
                        <li><i class="fa-solid fa-list"></i></li>
                    </ol>
                </div>
                <div class="search">
                    <input type="text" placeholder="Search ...................">
                    <i class="fa-solid fa-magnifying-glass"></i>
                </div>
                <a href="/blogs/New_blogs.html">
                <div class="add-blogs">
                    <i class="fa-solid fa-plus"></i><h4> New Blog</h4>
                </div>
            </a>
            </div>
        </div>
        
       
        <div class="blogs-container">
            <div id="blogs"></div>
            <div class="crud_operation" style="padding-top: 30px;">
               <h2>Manage Blogs</h2> 
            </div>
            <div class="edit_delete_Div" style="padding-top: 30px;">
                
                <div class="container">
                    <div class="row">
                        <div class="col-25">
                          <label for="fname">Search</label>
                        </div>
                        <div class="col-75">
                            <input type="text" id="Rollbox"  placeholder="Search Blog Id............">
                          </div>
                      </div>
                    <div class="row">
                      <div class="col-25">
                        <label for="fname">Blog title</label>
                      </div>
                      <div class="col-75">
                        <input type="text" id="Titlebox" name="titleBlob" placeholder="Blog title..">
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-25">
                        <label for="lname">Blog Descruption Image</label>
                      </div>
                      <div class="col-75">
                        <input type="file" id="img" name="image" placeholder="Write your Post..">
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-25">
                        <label for="country">Post date</label>
                      </div>
                      <div class="col-75">
                        
            
                        <input type="date" id="start" name="trip-start"
                            value="2023-01-01"
                            min="2018-01-01" max="2023-12-31">
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-25">
                        <label for="subject">Subject</label>
                      </div>
                      <div class="col-75">
                        <textarea id="Postbox" name="post" placeholder="Write something.."></textarea>
                      </div>
                    </div>
                    <br>
                    <div class="row">
                      <!-- <input type="submit" value="Post" id="postBtn"> -->
                      <button id="Insbtn">+ New Blog</button>
                      <button id="Selbtn">View</button>
                        <button id="Updbtn">Edit</button>
                        <button id="Delbtn">Delete</button>
                    </div>
                  </div>


            </div>
        </div>
    </div>
    <script type="module">
        // Fill the table ..............................................

            let TitleBox = document.getElementById("Titlebox");
            let PostBox = document.getElementById("Postbox");
            let PostDate = document.getElementById("start");

        let Allblogs = document.getElementById('blogs')
        let  container = document.createElement('div')
        Allblogs.appendChild(container);
    
        function AddItemToTable(title, date, post){
            let card = document.createElement('div')
            let tt = document.createElement('h3')
            let dt = document.createElement('h6')
            let pst = document.createElement('p')
            let br = document.createElement('br')

            // classes
            container.className = 'all'
            card.className = 'card'
        //  buttons 
            let edBtn = document.createElement("button");
            edBtn.innerHTML = "Edit";  

            let delBtn = document.createElement("button");
            delBtn.innerHTML = "Delete";
            
            // edBtn.addEventListener('click', ()=>{

            // })
            

            let tt2 = document.createTextNode(title)
            let dt2 = document.createTextNode(date)
            let pst2 = document.createTextNode(post)

            tt.appendChild(tt2)
            dt.appendChild(dt2)
            pst.appendChild(pst2)

            card.appendChild(tt)
            card.appendChild(dt)
            card.appendChild(pst2)
            card.appendChild(br)
            card.appendChild(edBtn)
            card.appendChild(delBtn)
            container.appendChild(card)

        }
            function AddAllItemToTable(Blogs_post){
                container.innerHTML = '';
                Blogs_post.forEach(element => {
                    AddItemToTable(element.BlogTitle,element.BlogDate,element.BlogPost);
                });
            }
                import { initializeApp } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-app.js";

                const firebaseConfig = {
                    apiKey: "AIzaSyCH-rRMi42mEFOY7AbZgxsRkqrXBI3wkY8",
                    authDomain: "fire9db-ebc8e.firebaseapp.com",
                    projectId: "fire9db-ebc8e",
                    storageBucket: "fire9db-ebc8e.appspot.com",
                    messagingSenderId: "96832741949",
                    appId: "1:96832741949:web:5a1c7c3556b3968a898054"
                };

                // Initialize Firebase
                const app = initializeApp(firebaseConfig);

                    import {
                        getFirestore, doc, getDoc,getDocs, setDoc, collection, addDoc, updateDoc, deleteDoc, deleteField
                    } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-firestore.js";


                    const db = getFirestore();

                    async function GetAllDataOnce(){
                        const querySnapshot = await getDocs(collection(db, 'blogs'));

                        var AllBlogs = [];
                        querySnapshot.forEach(doc =>{
                            AllBlogs.push(doc.data());
                        });
                        AddAllItemToTable(AllBlogs);
                    }

                    //   ADDING CUSTOM ID FROM FORM------------------------------------------------------------

                        // async function AddDocument_CustomID(){
                        //     var ref = doc(db, 'blogs', RollBox.value);

                        //     setDoc(ref, {
                        //         NameOfStd: NameBox.value,
                        //         RollNo: RollBox.value,
                        //         Section: SecBox.value,
                        //         Gender: GenBox.value
                        //     })
                        //     .then(() =>{
                        //         alert("Data inserted Successfully");
                        //     })
                        //     .catch((error) =>{
                        //         alert("unSuccessfull operation, errro " + error);
                        //     })
                        // }


                    // GET DOCUMENTS ......................................................

                            async function GetADocument(){
                                var ref = doc(db, 'blogs', RollBox.value);
                                const docSnap = await getDoc(ref);
                                
                                if(docSnap.exists()){
                                    TitleBox.value = docSnap.data().BlogTitle;
                                    PostDate.value = docSnap.data().BlogDate;
                                    PostBox.value = docSnap.data().BlogPost;
                                }
                                else{
                                    alert('No such Document')
                                }
                            }

                            async function UpdateFieldInDocument(){
                            var ref = doc(db, 'blogs', RollBox.value);

                            await updateDoc(ref, {
                                BlogTitle: TitleBox.value,
                                BlogDate: PostDate.value,
                                BlogPost: PostBox.value,
                            })
                            .then(() =>{
                                alert("Data updated Successfully");
                            })
                            .catch((error) =>{
                                alert("unSuccessfull operation, errro " + error);
                            })
                        }

                        
                        // DELETE A DOCUMENT ......................................................
                        async function DeleteDocument(){
                            var ref = doc(db, 'blogs', RollBox.value);
                            const docSnap = await getDoc(ref);
                            
                            if(!docSnap.exists()){
                                alert('Document not exist')
                                return;
                            }
                            else{
                            await deleteDoc(ref).then(()=>{
                                alert('Data deleted Successfully')
                            })
                            }
                        }
                    window.onload = GetAllDataOnce;



let NameBox = document.getElementById("Namebox");
  let RollBox = document.getElementById("Rollbox");
  let SecBox = document.getElementById("Secbox");
  let GenBox = document.getElementById("Genbox");

  let insBtn = document.getElementById("Insbtn");
  let selBtn = document.getElementById("Selbtn");
  let updBtn = document.getElementById("Updbtn");
  let delBtn = document.getElementById("Delbtn");


selBtn.addEventListener('click', GetADocument); 
updBtn.addEventListener('click', UpdateFieldInDocument);
delBtn.addEventListener('click', DeleteDocument);

    </script>
</body>
</html>